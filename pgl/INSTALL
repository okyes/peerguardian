Table of Contents:

Installation
Uninstall
Files
Requirements
Supported systems

##############################################################################

Installation:


Step 1: Get the source:
=======================
Either get the latest stable release from peerguardian.sourceforge.net and
unpack it.
Or get the current development code:
git clone git://peerguardian.git.sourceforge.net/gitroot/peerguardian/peerguardian


Step 2: Base configuration (Makefile)
=====================================
pgl consists of three components: the daemon pgld, the command line interface
pglcmd and the GUI pgl-gui. In the Makefile you can configure every component to
be (not) built.
Note (2010-05-18):  pgl-gui is not ready for usage, yet. Further it still uses
cmake as build system.

Especially for embedded devices (like router or NAS box) you might set the
LOWMEM option to yes. This disables storing of textual range descriptions.

Further you have options to turn on/off dbus support (currently disabled) and
zlib support for loading compressed blocklists.

Last but not least you can configure the paths pgl is installed to and uses.


Step 3: Compilation and installation
====================================
Once you have adjusted the Makefile to your needs issue these commands:
  cd peerguardian
  make
  make install


Hints for the obsolete cmake build system (only required for pgl-gui):
======================================================================
Required packages:
  Qt4 development files

git clone git://peerguardian.git.sourceforge.net/gitroot/peerguardian/peerguardian
cd peerguardian
mkdir build
cd build
cmake -DNOPGLD=1 -DNOPGLCMD=1 ..
make
make install

NOTE: It is strongly recommended to make only out-of-source builds (see above).
So don't issue the "cmake" command directly in the source - always do it in a
separate directory as e.g. the "build" directory. If you already have issued
"cmake" directly in the source, you have to take care to clean up the source
from any generated files, before you can issue "cmake" in another place.

Options to cmake:
-DCMAKE_INSTALL_PREFIX=/install_prefix
    Change the install prefix from the default /usr/local

-DNOPGLD=1
    Don't build pgld

-DNOPGLCMD=1
    Don't build pglcmd

-DNOPGLGUI=1
    Don't build pgl-gui

-DNODUBS=1
    For pgld only
    No DBus support (Auto-detect otherwise)

-DLOWMEM=1
    For pgld only
    Enable LOWMEM support for devices like routers etc
    This disables DBus

##############################################################################

Uninstall:

There is no UNINSTALL routine (yet). But for reference here is a file list as
pgl is installed per default:

pgld:
/etc/logrotate.d
/etc/logrotate.d/pgld
/usr/sbin/pgld
/var/log/pgl

pglcmd:
/etc/cron.daily/pglcmd
/etc/init.d/pgl
 + links in /etc/rc?.d/
/etc/logrotate.d/pglcmd
/etc/network/if-up.d/pglcmd
/etc/pgl/allow.p2p
/etc/pgl/blocklists.list
/etc/pgl/pglcmd.conf
/usr/bin/pglcmd
/usr/lib/pgl/pglcmd.defaults
/usr/lib/pgl/pglcmd.lib
/usr/lib/pgl/pglcmd.main
/usr/sbin/pglcmd.wd
/var/lib/blockcontrol
/var/log/pgl
/var/spool/blockcontrol

##############################################################################

Requirements:

Build dependencies pgld:
    - nfnetlink development files
    - libnetfilter-queue development files
    - libdbus development files (optional)
    - zlib development files (optional, for loading gz compressed blocklists
        directly)

Runtime environment pgld:
    - the above libraries
    - iptables (required)
    - netfilter kernel support (kernel >= 2.6.13 for NFQUEUE support)
      Either as modules or directly built in the kernel. These are the modules
      that are loaded here (with pglcmd):
        iptable_filter
        ip_tables
        ipt_REJECT
        nf_conntrack
        nf_conntrack_ipv4
        nf_defrag_ipv4
        nfnetlink
        nfnetlink_queue
        x_tables
        xt_iprange
        xt_mark
        xt_multiport
        xt_NFQUEUE
        xt_state
        xt_tcpudp
      The list was compiled with:
        lsmod|grep -E "^x|^nf|^ip"|grep -Ev "^ip6|^ipv6"|sed "s| .*||"|sort
      Note that xt_ may be named ip_ or ipt_ on older systems.

Runtime environment pglcmd:
    - pgld
    - wget (optional, needed for blocklists update)
    - p7zip (optional, needed for blocklists packed as .7z)
    - unzip (optional, needed for blocklists packed as .zip)
    - start-stop-daemon (optional)
    - awk, sed, grep, basename, dirname, cat, cd, mv, cp, zcat, md5sum, renice,
        pidof (those should really be on every system)
    - /usr/bin/printf (optional, needed during "update" for archive type
        detection)
    - /lib/lsb/init-functions (optional, because as fallback there's a modified
        copy of the Debian init-functions in pglcmd)
        Used functions, provided by /lib/lsb/init-functions (version >= 3.1):
        - start_daemon
        - killproc
        - pidofproc
        - status_of_proc
        - log_failure_msg
        - log_warning_msg
        - log_success_msg

Runtime environment pgl-gui:
    - pgld
    - pglcmd
    - Qt 4

##############################################################################

Supported systems:

pgl was written and tested under Debian Squeeze. However it should run under
every Linux distribution or other POSIX compliant systems.
